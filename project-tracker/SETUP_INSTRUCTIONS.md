# Инструкция по настройке системы управления дефектами

## 1. Настройка Supabase

### 1.1 Создание проекта
1. Зайдите на [supabase.com](https://supabase.com)
2. Создайте новый проект
3. Сохраните URL и anon key

### 1.2 Применение миграции
1. Откройте SQL Editor в Supabase Dashboard
2. Скопируйте содержимое файла `supabase_migration.sql`
3. Выполните SQL код
4. Создайте storage bucket:
   - Перейдите в Storage
   - Создайте bucket с именем `defect-attachments`
   - Установите политики доступа

### 1.3 Настройка аутентификации
1. Перейдите в Authentication > Settings
2. Отключите email confirmation (для разработки)
3. Настройте минимальную длину пароля (рекомендуется 8 символов)

## 2. Настройка приложения

### 2.1 Установка зависимостей
```bash
cd project-tracker
npm install
```

### 2.2 Создание .env файла
Создайте файл `.env` в корне project-tracker:

```env
VITE_SUPABASE_URL=your_supabase_url
VITE_SUPABASE_ANON_KEY=your_supabase_anon_key
```

### 2.3 Запуск приложения
```bash
npm run dev
```

## 3. Первый запуск

### 3.1 Регистрация первого пользователя
1. Откройте приложение
2. Нажмите "Нет аккаунта? Зарегистрироваться"
3. Заполните форму:
   - Email: ваш email
   - Пароль: минимум 8 символов
   - Полное имя: ваше имя
   - Роль: выберите "Менеджер" для полного доступа

### 3.2 Создание первого проекта
1. После входа перейдите в раздел "Проекты"
2. Нажмите "Добавить проект"
3. Заполните информацию о проекте

### 3.3 Добавление этапов проекта
1. Откройте созданный проект
2. Добавьте этапы (например: "Подготовка", "Строительство", "Завершение")

### 3.4 Создание дефектов
1. Перейдите в раздел "Дефекты"
2. Нажмите "Создать дефект"
3. Заполните информацию о дефекте

## 4. Роли пользователей

### Менеджер (manager)
- Полный доступ ко всем функциям
- Создание, редактирование и удаление проектов
- Создание, редактирование и удаление дефектов
- Управление пользователями

### Инженер (engineer)
- Просмотр всех проектов и дефектов
- Создание и редактирование дефектов
- Редактирование назначенных на него дефектов
- Добавление комментариев и вложений

### Наблюдатель (observer)
- Только просмотр проектов и дефектов
- Просмотр комментариев и истории

## 5. Основные функции

### 5.1 Управление дефектами
- Создание дефекта с указанием приоритета, исполнителя и срока
- Изменение статуса: Новая → В работе → На проверке → Закрыта/Отменена
- Добавление комментариев
- Загрузка вложений
- Просмотр истории изменений

### 5.2 Поиск и фильтрация
- Поиск по названию и описанию
- Фильтрация по статусу
- Фильтрация по приоритету
- Фильтрация по исполнителю
- Фильтрация по проекту

### 5.3 Экспорт отчётов
- Экспорт списка дефектов в CSV
- Экспорт с учётом текущих фильтров

### 5.4 Аналитика
- Дашборд с графиками
- Статистика по статусам дефектов
- Статистика по приоритетам
- Статистика по проектам

## 6. Разработка

### 6.1 Структура проекта
```
src/
  ├── components/      # Vue компоненты
  ├── composables/     # Композабл функции
  ├── lib/            # Библиотеки (Supabase клиент)
  ├── router/         # Роутинг
  ├── utils/          # Утилиты
  └── assets/         # Статические файлы
```

### 6.2 Сборка для production
```bash
npm run build
```

### 6.3 Проверка кода
```bash
npm run lint
```

## 7. Безопасность

### 7.1 Row Level Security (RLS)
Все таблицы защищены политиками RLS, которые:
- Проверяют аутентификацию пользователя
- Ограничивают доступ в зависимости от роли
- Запрещают несанкционированный доступ к данным

### 7.2 Хранение паролей
Supabase использует bcrypt для хеширования паролей

### 7.3 Защита от XSS
Vue автоматически экранирует выводимые данные

### 7.4 Защита от CSRF
Supabase использует токены для защиты от CSRF

## 8. Поддержка

При возникновении проблем:
1. Проверьте консоль браузера на ошибки
2. Проверьте логи Supabase
3. Убедитесь, что все миграции применены
4. Проверьте настройки RLS политик

## 9. Дальнейшее развитие

Возможные улучшения:
- Добавление уведомлений
- Интеграция с email
- Добавление отчётов в Excel формате
- Добавление календаря с дедлайнами
- Интеграция с мессенджерами
